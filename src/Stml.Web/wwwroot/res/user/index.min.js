function createUserSuccess(n){n.isSuccess?(toastr.success("新建用户成功！"),$("#create-modal").modal("hide"),$("#tb-users").bootstrapTable("refresh",{pageNumber:1})):toastr.error("新建用户失败： "+n.errors[0])}function editUserSuccess(n){n.isSuccess?(toastr.success("编辑用户成功！"),$("#edit-modal").modal("hide"),$("#tb-users").bootstrapTable("refresh",{pageNumber:1})):toastr.error("编辑用户失败： "+n.errors[0])}(function(){"use strict";$(function(){var t=$("#tb-users"),i=$("#create-modal"),r=$("#edit-modal"),u="/User/CreatePartial",f="/User/EditPartial",e="/User/Delete",o={classes:"table",method:"get",url:"/User/List",columns:[{field:"userName",title:"用户名"},{field:"role",title:"角色",formatter:function(n,t){return t.roles.length===0?"-":t.roles.map(function(n){return'<span class="badge badge-success">'+n.displayName+"<\/span>"}).join(" ")}},{field:"email",title:"邮箱"},{field:"creation",title:"创建日期",formatter:function(n,t){return"<div>"+t.dateOfCreation+'<\/div><div class="small text-muted">'+t.timeOfCreation+"<\/div>"}},{field:"state",title:"是否启用",formatter:function(n,t){return'<div class="state icheckbox_minimal-red'+(t.isActive?" checked":"")+'"><\/div>'}},{field:"operate",title:"操作",width:"100px",formatter:function(n,t){var i='<div class="dropdown">';return(window.user.check("UserEdit")||window.user.check("UserDelete"))&&(i+='<a href="#" class="btn text-primary" data-toggle="dropdown" data-boundary="viewport" aria-haspopup="true" aria-expanded="false"><i class="fa fa-bars font-lg"><\/i><\/a>',i+='<div class="dropdown-menu pull-right">',window.user.check("UserEdit")&&(i+='<a class="dropdown-item edit-user" data-user-id="'+t.id+'" data-toggle="modal"><i class="fa fa-pencil"><\/i> 编辑<\/a>'),window.user.check("UserDelete")&&(i+='<a class="dropdown-item delete-user" data-user-id="'+t.id+'"><i class="fa fa-trash"><\/i> 删除<\/a>'),i+="<\/div><\/div>"),i}}],uniqueId:"Id",locale:"zh-CN",search:!0,searchAlign:"left",searchOnEnterKey:!0,pagination:!0,paginationLoop:!1,pageNumber:1,pageSize:5,pageList:[10,25,50],sidePagination:"server",queryParams:function(n){return n},responseHandler:function(n){return{total:n.total,rows:n.rows}}},n={initTable:function(){t.bootstrapTable("destroy").bootstrapTable(o)},create:function(){i.find(".modal-content").load(u,function(){i.modal("show")})},edit:function(n){r.find(".modal-content").load(f+"?id="+n,function(){r.modal("show")})},"delete":function(n){$.post(e,{id:n},function(){toastr.success("删除用户成功!");t.bootstrapTable("refresh",{pageNumber:1})})}};$(".create-user").click(function(){n.create()});$(document).on("click",".edit-user",function(){var t=$(this).data("user-id");n.edit(t)});$(document).on("click",".delete-user",function(){var t=$(this).data("user-id");n.delete(t)});n.initTable()})})();